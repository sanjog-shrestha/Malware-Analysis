# Static Malware Analysis Toolkit

## Objective

To perform a comprehensive static analysis of a given malware sample, aiming to extract maximal information without execution. This involves determining the file type using a hex editor, assessing file obfuscation with tools like Exeinfo PE and PE Studio, identifying malicious artifacts and functionalities with PE Studio, evaluating VirusTotal impact, and documenting all findings to inform further analysis and incident response efforts.

## Skills Learned

-  File Type Identification
-  Malware Obfuscation Techniques
-  Use of Analysis Tools (Exeinfo PE, PE Studio)
-  Understanding PE File Structure
-  Threat Intelligence Gathering (VirusTotal)
-  Analytical Thinking
-  Attention to Detail


### Tools Used

- Hex Editor (e.g., HxD, 010 Editor)
- Exeinfo PE
- PE Studio
- VirusTotal

## Steps

![image](https://github.com/user-attachments/assets/3f910733-be58-44e7-9d2d-d206a124be56)

Ref 1: Malware 

In this project, the malware that we used is WannaCry.jpeg ransomware

![image](https://github.com/user-attachments/assets/d9bbd133-ea3b-464a-9fa6-f15a5fdc1eca)

Ref 2: Hex Editor

In this project, the hex editor plays a crucial role in the initial phase of static malware analysis by allowing analysts to examine the raw binary data of the malware sample. By opening the file in a hex editor, analysts can inspect the hexadecimal representation of the file's contents, enabling them to identify key characteristics such as the file signature, which indicates the file type (e.g., the "MZ" signature for Portable Executable files). This identification is essential for understanding the target platform and potential functionality of the malware. Additionally, the hex editor facilitates the detection of embedded strings, code sections, and other critical data that may provide insights into the malware's behavior and intentions, making it an indispensable tool for uncovering the underlying structure of the malicious software.

![image](https://github.com/user-attachments/assets/0a1335c7-cb98-402d-871f-4feb384a911c)

Ref 3: Malware Analysis

In this project, in Hex Editor; we could identify the first two bytes: 4D and 5A and the file can be identified by the ASCII string "MZ" at the beginning in the file. While researching, we could find out that it is DOS MZ executable file. So, we could determine that the malware use the obfuscation technique to hide the malware in the image file.

![image](https://github.com/user-attachments/assets/f58e200f-0568-4436-a6fa-6c7a51f49c2f)

Ref 4: Exeinfo 

In this project, Exeinfo PE serves as a versatile and user-friendly tool for examining the properties and metadata of Portable Executable (PE) files, which are commonly used for Windows-based malware. By loading the malware sample into Exeinfo PE, analysts can quickly and efficiently extract a wealth of information about the file, including:
- File information: such as the file name, size, and hash values (MD5, SHA-1, SHA-256)
- Entry point: the address of the first instruction that the program will execute when loaded into memory
- Section information: details about the named blocks of data within the PE file, including their size, virtual address, and characteristics
- Linker and subsystem information: revealing the version of the linker used to create the PE file and the intended subsystem (e.g., Windows GUI, Windows console)
- Import and export information: identifying the dynamic-link libraries (DLLs) that the PE file imports and the functions it exports, which can be used by other programs

Exeinfo PE's ability to display this comprehensive set of metadata enables analysts to gain valuable insights into the malware's structure, potential behavior, and compatibility with different Windows systems. Furthermore, Exeinfo PE can attempt to unpack or decompress packed PE files, helping analysts access the original, unobfuscated code for further analysis.

![image](https://github.com/user-attachments/assets/e6a11748-0993-4d3b-9820-d187740143ea)
![image](https://github.com/user-attachments/assets/00b04a05-be7e-4140-bf21-bf365b6c9d16)
![image](https://github.com/user-attachments/assets/08e3a5ec-d016-4ba4-8d8c-1455524b9676)
![image](https://github.com/user-attachments/assets/19baec6b-6145-446b-ab42-9b2a3127113b)

Ref 5: PEStudio

In this project, PE Studio plays a vital role in the static analysis of malware by providing a comprehensive examination of Portable Executable (PE) files to identify suspicious artifacts and potential malicious behavior. It enables analysts to quickly assess various aspects of the malware sample, such as imports, exports, and resources, while highlighting indicators of compromise (IOCs) commonly associated with malicious activities. PE Studio's user-friendly interface allows for efficient detection of unusual patterns, such as anomalous file structures or unexpected behaviors, which can signal the presence of malware. By leveraging PE Studio, analysts can streamline the initial assessment process, facilitating a deeper understanding of the malware's functionality and potential threats it poses to systems.
