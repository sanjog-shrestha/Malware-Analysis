# Static Malware Analysis Toolkit

## Objective

To perform a comprehensive static analysis of a given malware sample, aiming to extract maximal information without execution. This involves determining the file type using a hex editor, assessing file obfuscation with tools like Exeinfo PE and PE Studio, identifying malicious artifacts and functionalities with PE Studio, evaluating VirusTotal impact, and documenting all findings to inform further analysis and incident response efforts.

## Skills Learned

-  File Type Identification
-  Malware Obfuscation Techniques
-  Use of Analysis Tools (Exeinfo PE, PE Studio)
-  Understanding PE File Structure
-  Threat Intelligence Gathering (VirusTotal)
-  Analytical Thinking
-  Attention to Detail


### Tools Used

- Hex Editor (e.g., HxD, 010 Editor)
- Exeinfo PE
- PE Studio
- VirusTotal

## Steps

![image](https://github.com/user-attachments/assets/3f910733-be58-44e7-9d2d-d206a124be56)

Ref 1: Malware 

In this project, the malware that we used is WannaCry.jpeg ransomware

![image](https://github.com/user-attachments/assets/d9bbd133-ea3b-464a-9fa6-f15a5fdc1eca)


Ref 2: Use of aliases in pfsense

It is used in PfSense to group IP addresses for easier management and reference in firewall rules. It is created for gateway IP addresses (192.168.199.1 and 192.168.94.1) to simplify rule creation and maintenance which allowed for more readable and organized firewall rules by replacing IP addresses with descriptive names (e.g., "Gateway").

![image](https://github.com/user-attachments/assets/d8edf45d-26ae-45af-821d-e833a9440466)
![image](https://github.com/user-attachments/assets/cf3d504a-5d09-4b8a-9ceb-087254e168e1)

Ref 3: Firewall Rules

The LAN rules in this project play a crucial role in controlling and securing the network traffic within one of the network segments. Specifically:
The first LAN rule allows all devices in that network segment to access the gateway IP address. This ensures that devices on the LAN can connect to the other network segment through the gateway.
The second LAN rule explicitly allows a specific device (or group of devices) to access any device on the network. This is likely done to grant certain devices the necessary access to communicate with other devices.
The third LAN rule explicitly denies any other devices in that network segment from connecting to devices outside of that segment. This rule enforces the network segmentation by restricting access between the two network segments, except for the specific access granted in the previous rules.
These LAN rules, in combination with the rules for the other network segment, demonstrate a well-thought-out network segmentation strategy. This strategy controls and limits the communication between the different network segments, enhancing the overall security of the home network setup.

![image](https://github.com/user-attachments/assets/2f4410e0-adf8-407b-8c5e-e6144cd1c2c9)
![image](https://github.com/user-attachments/assets/d139d1f1-5226-46be-b899-cb875ecc4f21)
![image](https://github.com/user-attachments/assets/1bd8b6af-d1dd-4a0b-8281-3d89f126d9ca)

Ref 4: Proof of Evidence

![image](https://github.com/user-attachments/assets/d11ffbfc-cd1d-4ac6-bcf7-d91e4a31bba2)
![image](https://github.com/user-attachments/assets/947fe078-b023-45be-a636-f956379349ef)
![image](https://github.com/user-attachments/assets/745c8195-7cdb-4472-8b7a-9632cceb6fe2)

Ref 5: Snort Configuration

In this project, Snort was configured as an Intrusion Detection System (IDS) to monitor and analyze the network traffic within the 192.168.199.0/24 network segment. Snort was deployed on the Pfsense firewall and was set to operate in IDS mode, rather than IPS (Intrusion Prevention System) mode, which means it was tasked with detecting and logging potential security threats, but not automatically blocking them.

The purpose of including Snort in this home network security setup was to provide an additional layer of security by detecting and alerting on any suspicious or malicious network activity. By analyzing the network traffic against a set of predefined rules, Snort was able to identify potential intrusion attempts and generate alerts, allowing the network administrator to further investigate and respond to any security incidents.

The successful deployment and testing of Snort in this project demonstrated the value of incorporating an IDS system as part of a comprehensive network security strategy, even in a home network environment. The ability to monitor and detect potential threats in real-time can greatly enhance the overall security posture and help the network administrator take appropriate actions to mitigate any identified risks.





